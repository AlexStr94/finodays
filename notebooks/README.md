# Используемые библиотеки и модели
* pandas
* numpy
* nltk
* spacy
* string
* sklearn
* langdetect
* mathplotlib
* seaborn
* openai
* optuna
* catboost
* tensorflow/keras

# Topic Modeling

## filter_text
Первая функция принимает на вход датасет и возвращает его копию с новой колонкой cleaned_sale, содержащей очищенные предложения. Очистка происходит с помощью библиотек nltk и spacy, а также удаления знаков препинания.

## topics
Вторая функция topics принимает на вход датасет и создает новую колонку topic, содержащую топик каждой покупки. Для этого используется метод LatentDirichletAllocation из библиотеки sklearn, который позволяет выделить темы в тексте. Также используется нейросеть openai для определения топика на основе ключевых слов.

# Neyro_LSTM

Дообработанная вручную выборка из примерно 20 000 строк от датасета из первого ноутбука импортируется сюда, где остаются только колонки с очищенным текстом и топиками. Тексты - фичи для модели, а топики - таргет. Топики мы обрабатываем при помощи шифра словарём, где каждому числу соотвествует определённый топик. Тексты векторизируются и на этих числовых представлениях текстов обучается нейросеть (из всех архитектур, отобрана и загружена в репозиторий LSTM, показавшая лучшую F1 меру на тестовой выборке). При помощи оптимизированного перебора параметров с Optuna получаем нейросеть с лучшими показателями. Её результаты сохраняются для предсказания топиков на новых текстов транзакций от клиентов.  

# Time_series_for_cashbacks

Этот код представляет собой систему для прогнозирования расходов в следующем месяце на основе предыдущих двух лет. Обучение проводилась на данных, сшитых из разных клиентов. Каждый клиент исходного датасета становится одним месяцем трат обощённого клиента. Один обобщённый клиент - 24 старых. Код включает в себя создание мок-данных, добавление временных признаков, агрегацию данных, обучение нейронной сети и тестирование модели. В результате, нейросеть с лучшими параметрами, полученными при помощи Optuna, сохраняется для будущего использования.

# Test_LSTM & Cashbacks_next_month

Эти файлы демонстрируют работу кода по присваиванию категории покупки и рассчёта категорий кэшбека на следующий месяц. Они используют модели из Neyro_LSTM и Time_series_for_cashbacks соответственно.





